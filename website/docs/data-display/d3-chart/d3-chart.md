---
title: D3 Chart
disabled: true
fileSource: d3-chart
tabName: Concept
---

Этот компонент является основой для построения графиков.

Мы не манипулируем вашими данными и не пытаемся из них что-то вычислить, отсортировать или проверить. Манипуляции с данными — работа команд, не компонента.

Мы считаем, что графики — это сложный, комплексный компонент, который нельзя применять одной строчкой, поэтому его API более развесистый и поддерживает все концепции дизайн-системы.

@## Концепция

- Мы хотим дать вам удобную возможность использовать императивный стиль d3 с декларативным подходом React.
- В основе всех графиков лежит d3-scale, который вы передаете в наши графики в настроенном виде.
- Мы стараемся дать доступ к каждой `svg`-ноде, чтобы вы могли дополнить или изменить её.

Каждый элемент который вы будете размещать на графике имеет под собой реальный svg-элемент или группу элементов. Например, когда вы рендрите `<Line/>`, вы получите svg `<line d={...}>`, и все свойства будут сквозить на этот элемент.

Когда вы рендерите `<Line.Dots/>`(точки на линейном графике), вы получаете множество `<circle cx={...} cy={...}/>`, и все свойства будут сквозить на эти элементы.

Для точечного изменения свойств каждой конкретной точки нужно передать функцию, которая будет вызываться на каждой точке с рассчитанными свойствами этой точки.

```jsx
<Line.Dots>
  {(props) => {
    return {
      // ...your_props
    };
  }}
</Line.Dots>
```

> Функцию можно положить и в одиночный элемент, если ваши свойства вычисляются динамически.

Многие `svg`-элементы не поддерживают вложенность, поэтому мы рендерим эти элементы последовательно.
Например,

```jsx
<Line>
  <Line.Dots />
</Line>
```

не вложит `<circle/>` в `<line/>`, а отрисует их друг за другом.

За всю стилистику графиков отвечает CSS. Про его кастомизацию можно почитать в гайде [Themes](/style/themes/).

@## Основа

Любой `svg`-контейнер должен иметь абсолютные значения своего размера.

Про виды `scale`, их `range` и `domain` можно почитать на [странице d3 на GitHub](https://github.com/d3/d3-scale).

> `range` горизонтального `scale` задается перевернутым, чтобы начало отсчета было в нижнем левом углу.

@example common

@## Отступы

Размер `svg` и размер графика обычно различаются, чтобы не допустить обрезания вспомогательных элементов, таких как оси, значения на оси и легенда.

Поэтому в `scale.range()` задаются значения со сдвигом.

@example margin

@## Оси

На самом деле, оси координат уже заданы, когда вы передали `scale` в рутовый компонент, однако для отрисовки нужно их указать.

- `XAxis/YAxis` - являются осевыми линиями.
- `Ticks` - являются значениями на оси.

Так же можно располагать несколько осей с разными позициями.

Количество тиков можно получить из метода `scale.ticks` или `scale.domain`. Чтобы вычислить примерное количество тиков, можно разделить размер графика на размер одного тика.

> `YAxis` по умолчанию скрыта (`hide=true`) в соответствии с дизайном.

@example axis

@## Значения на оси

Значения и свойства на оси можно изменять, передав функцию.

Тегом по умолчанию является `<text/>`, но его можно изменить, определив свойство `tag`, например, на `foreignObject` для вставки `html`-компонентов.

> В аргументах функции вы можете получить вычисленные координаты `x/y` и произвести свои манипуляции со сдвигом.

@example axis-ticks

@## Вспомогательные линии

Вспомогательные линии, формируются также, как и тики.

> Для простоты `ticks` можно указать на самом компоненте `Axis`, и он автоматически передастся на `<Axis.Ticks/>` и на `<Axis.Grid/>`.

@example axis-grid

@## Aдаптивный график

Для нормального отображения `svg` графиков на адаптивных макетах нужно динамически расчитывать ширину и высоту блока,
поэтому мы создали компонент `ResponsiveContainer`, который поддерживает все свойства [Box](/layout/box-system/box-api) c помощью которых можно гибко настраивать размеры блока.

> ResponsiveContainer поддерживает свойство `aspect` - это отношение размеров между шириной и высотой блока.

```jsx
<ResponsiveContainer aspect={1}> // width = height ...</ResponsiveContainer>
```

@example responsive

@page line
@page bar
@page d3-chart-api
